<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>DinoJS Demo</title>
		
		<!-- jQuery -->
		<script type="text/javascript" src="../lib/misc/jquery-1.6.min.js"></script>
		<!-- DinoJS -->
		<script type="text/javascript" src="../build/dino-js.js"></script>
		<link rel="stylesheet" type="text/css" href="../build/dino-js.css">
		<!-- DinoJS theme -->
		<link rel="stylesheet" type="text/css" href="../themes/default/dino-theme.css">
		<!-- Iconsets -->
		<link rel="stylesheet" type="text/css" href="../iconsets/jquery-ui/jquery-ui-iconset.css">
		<link rel="stylesheet" type="text/css" href="../iconsets/silk/icons.css">
		
		<!-- jQuery UI theme -->
		<!-- link rel="stylesheet" type="text/css" href="../themes/smoothness/jquery-ui-theme.css" -->
		<!-- SHJS -->
		<script type="text/javascript" src="../lib/shjs/sh_main.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_javascript.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_css.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_html.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../lib/shjs/css/sh_emacs.min.css">
		<!-- Datepick -->
		<script type="text/javascript" src="../lib/datepick/jquery.datepick.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../lib/datepick/jquery.datepick.css">
		<link rel="stylesheet" type="text/css" href="../lib/datepick/smoothness.datepick.css">
		<!-- Autocomplete -->
		<script type="text/javascript" src="../lib/autocomplete/jquery.autocomplete.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../lib/autocomplete/jquery.autocomplete.css">

		<link rel="stylesheet" type="text/css" href="css/template4.css">
		<!--script type="text/javascript" src="js/template4.js"></script-->		
		
    <!--script type="text/javascript" src="https://www.google.com/jsapi?key=YOUR_KEY_HERE"></script-->
		
		
	</head>
<body>
	
	
<script>


var generate_grid_page = function(i0, i1) {
	
	// Типы данных
	// - ID
	// - Строка
	// - Число
	// - Активная иконка
	// - Ссылка
	// - Чекбокс
	// - Денежные единицы
	// - Дата
	
	var list = [];
	for(var i = i0; i < i1; i++) {
		list.push({
			id: i,
			string: 'Item ' + (i+1),
			number: Math.random()*1e3,
			icon: 'exclamation',
			ref: 'http://google.ru',
			flag: false,
			currency: Math.random()*1e2,
			count: (Math.random()*1e2).toFixed(),
			date: Dino.format_date(new Date())//.toLocaleString()
		});
	}
	return list;
}



$(document).ready(function(){

gridData = new Dino.data.ArrayDataSource();

try{
    
var grid = $.dino({
  renderTo: 'body',
  dtype: 'grid',
  cls: 'dino-border-all dino-corner-all',
  width: 800,
  content: {
    height: 300,//'auto',
    state: 'scrollable'
//    style: {'padding-right': '18px'}
  },
//  headerCls: 'dino-bg-highlight',
  tableModel: {
    columns: [{
      dataId: 'id',
      header: 'ID',
      width: 50,
    }, {
      dataId: 'string',
      header: 'Строка'
    }, {
      dataId: 'number',
      header: 'Число',
      format: function(v) { return v.toFixed(2) },
    }, {
      dataId: 'icon',
      cls: 'silk-icon dino-clickable',
      width: 30,
      binding: function(val) { this.states.set('silk-icon-'+val); },
    }/*, {
      header: 'Ссылка',
      content: {
        dtype: 'anchor',
        text: 'ссылка',
        dataId: 'ref'
      },
      binding: 'skip'
    }*/, {
      dataId: 'flag',
      width: 50,
      content: {
        dtype: 'checkbox'
      },
      header: {
        content: {
          dtype: 'checkbox',
          checked: false        
        }        
      },
      binding: 'skip'
    }, {
      dataId: 'currency',
      header: 'Цена',
      format: Dino.format_currency.rcurry('$')
    }, {
      dataId: 'date',
      header: 'Дата',
//      format: Dino.format_date
    }]
  },
  data: gridData,
  components: {
    pager: {
      dtype: 'pager',
      count: 200,
      pageSize: 40,
      cls: 'dino-border-top',
      onIndexChanged: function(e) {
        // генерируем данные и добавляем их в источник данных виджета
				if(gridData.source.length < e.to) {
	        var data_page = generate_grid_page(e.from, e.to);
	        var j = 0;
	        for(var i = e.from; i < e.to; i++) {
	          gridData.source[i] = data_page[j++];
	        }					
				}

        gridData.filter_chain = function(data){
          var out = [];
          for(var i = 0; i < data.length; i++)
            if(i >= e.from && i < e.to) out.push(i);
          return out;
        };
					
        gridData.events.fire('onValueChanged');
        
				grid.$layoutChanged();
				
//        console.log(profiler.print_result('widget'));
//        profiler.clear('widget');

      }
    }
  }
});

grid.$render('body');

grid.pager.setIndex(0);


}
catch(e) {
	console.log(Dino.format("%s (%s)", e.message, e.lineNumber));
}


});
	
</script>
	
</body>
</html>
