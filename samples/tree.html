<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DinoJS: Деревья</title>

		<!-- jQuery -->
		<script type="text/javascript" src="../lib/misc/jquery-1.4.2.min.js"></script>
		<!-- DinoJS -->
		<script type="text/javascript" src="../build/dino-js.js"></script>
		<link rel="stylesheet" type="text/css" href="../build/dino-js.css">
		<!-- DinoJS theme -->
		<link rel="stylesheet" type="text/css" href="../themes/default/dino-theme.css">
		<!-- jQuery UI theme -->
		<link rel="stylesheet" type="text/css" href="../themes/smoothness/jquery-ui-theme.css">
		<!-- SHJS -->
		<script type="text/javascript" src="../lib/shjs/sh_main.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_javascript.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_css.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_html.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../lib/shjs/css/sh_emacs.min.css">

		<link rel="stylesheet" type="text/css" href="css/template2.css">
		<script type="text/javascript" src="js/template2.js"></script>


</head>
<body>






<div id="sample-simple-tree">
<style>	
/*
.simple-tree-node > ul {
	padding-left: 20px;
}
*/

.dino-tree-node-content {
	cursor: default;
}
	
</style>
<script>
sample('sample-simple-tree', function(){
	
return $.dino({
  dtype: 'tree',
	cls: 'simple-tree',
	
	treeModel: {
		node: {
			cls: 'simple-tree-node',
			expandOnShow: true,
			components: {
				content: {
					showLeftIcon: true,
					components: {
						leftIcon: {
							states: {
	              'brick': 'led-icon-brick',
	              'door': 'led-icon-door',
	              'user': 'led-icon-user'								
							}
						}
					}
				}				
			}
		}
	},
  subtree: [{
    text: '1 этаж',
    icon: 'brick',
//		toggleOnClick: true,
    subtree: [{
      text: 'каб. 111',
      icon: 'door',
      subtree: [{
//        state: ['user', 'leaf'],
        text: 'Волков А.А.',
				isLeaf: true,
				icon: 'user'
      }]
    }, {
      text: 'каб. 112',
      icon: 'door',
      subtree: [{
//        state: ['user', 'leaf'],
        text: 'Куницына А.Б.',
				isLeaf: true,
				icon: 'user'
      }, {
//        state: ['user', 'leaf'],
        text: 'Медведев Р.В.',
				isLeaf: true,
				icon: 'user'
      }]
    }, {
      text: 'каб. 113',
      icon: 'door'
    }]
  }]
});
	
	
});	
	
</script>	
<div class="desc">
	<p>Простое (легковесное с точки зрения разметки) дерево, элементами которого является <strong>Dino.widgets.TextItem</strong>.</p>
	<p>Отступ поддерева создается с помощью margin-left, поэтому выделить всю строку нельзя.</p>
</div>
</div>





<div id="sample-binding-tree">
<style>	

</style>
<script>
sample('sample-binding-tree', function(){
	
var treeData = [{
  name: 'Хряков С.И.',
  type: 'computer',
  children: [{
    name: 'C:',
    type: 'drive',
    children: [{
      name: 'WINDOWS',
      type: 'folder'
    }]
  }, {
    name: 'D:',
    type: 'drive',
    children: [{
      name: 'Фильмы',
      type: 'folder',
      children: [{
        name: 'Звездные Войны 1.avi',
        type: 'file'
      }, {
        name: 'Звездные Войны 3.avi',
        type: 'file'
      }, {
        name: 'Миссия Серенити.avi',
        type: 'file'
      }]
    }, {
      name: 'Работа',
      type: 'folder',
      children: [{
        name: 'bash.org.ru_лучшее.txt',
        type: 'file'
      }]
    }, {
      name: 'README.txt',
      type: 'file'
    }]
  }, {
    name: 'Z:',
    type: 'drive',
  }]
}];	
	
	
return $.dino({
  dtype: 'tree',
	cls: 'dynamic-tree',
	
  data: treeData,
	
  isDynamic: true,
	
	treeModel: {
		node: {
			cls: 'dynamic-tree-node',
			components: {
		    content: {
		      components: {
		        leftIcon: {
		          states: {
		            'computer': 'led-icon-computer',
		            'drive': 'led-icon-drive',
		            'folder': 'led-icon-folder',
		            'file': 'led-icon-page',
		          }
		        },
		      },
					showLeftIcon: true,
		      dataId: 'name'
		    }				
			},
			binding: function(val) {
				this.opt('icon', val.type);
				if(val.type == 'file') this.opt('isLeaf', true);				
			}
		}
	}
	
});
	
	
});	
	
	


</script>	
<div class="desc">
	<p>Чем примечательно подключение данных к дереву? Дело в том, что специального источника данных для деревьев нет, используется обычный 
	<strong>Dino.data.DataSource</strong>, а каждый элемент данных имеет именованный список, содержимое которого считается набором дочерних узлов.
	Виджеты DinoJS при биндинге по умолчанию используют имя <u>children</u>, хотя его можно изменить через параметры инициализации.</p>
</div>
</div>




<script>
/*	
var drag = null;
var proxy = null;	

$('body').mousemove(function(e){
	if(!drag) return;
	
	if(!drag.started) {
//		if(drag.x != e.pageX || drag.y != e.pageY){
			
//		}
	}
	else {
		proxy.el.css({'left': e.pageX+3, 'top': e.pageY+3});
	}
	
});
	
	
$('body').mouseup(function(e){
	
	if(drag && drag.started) {
		proxy.destroy();
		
		var target = $(e.originalTarget);
		var w = target.dino();
		if(!w || !w.options.dropTarget){
			target.parents().each(function(i, el){
				w = $(el).dino();
				if(w && w.options.dropTarget) return false;
			});
		}
		
		if(w) {
			w.events.fire('onDrop', {source: drag.source});
		}
		
		drag = null;
	}
	
});	
*/	
	
	
</script>




<div id="sample-tree-dragndrop">
<style>	
	
</style>
<script>
sample('sample-tree-dragndrop', function(){
	
return $.dino({
  dtype: 'tree',
	cls: 'simple-tree',
	
	treeModel: {
		node: {
			cls: 'simple-tree-node',
			expandOnShow: true,
			components: {
				content: {
					cls: 'dino-clickable',
					showLeftIcon: true,
					components: {
						leftIcon: {
							states: {
	              'brick': 'led-icon-brick',
	              'door': 'led-icon-door',
	              'user': 'led-icon-user'								
							}
						}
					},
					draggable: true,
					onDrag: function(e) {
						this.parent.states.set('dragged');
						
						e.dragData.proxy = $.dino({
							dtype: 'text',
							text: this.getText(),
							cls: 'dino-border-all',
							style: {'background-color': '#fff'},
							opacity: .7
						});
						
					},
					onDrop: function(e) {
						if(this != e.source)
							this.parent.subtree.addItem(e.source.parent);
							
						e.source.parent.states.clear('dragged');
					},
					droppable: true					
				}		
			},
//			states: {
//				'dragged': 'dino-hidden'
//			}
		}
	},
  subtree: [{
    text: '1 этаж',
    icon: 'brick',
		toggleOnClick: true,
    subtree: [{
      text: 'каб. 111',
      icon: 'door',
      subtree: [{
//        state: ['user', 'leaf'],
        text: 'Волков А.А.',
				isLeaf: true,
				icon: 'user'
      }]
    }, {
      text: 'каб. 112',
      icon: 'door',
      subtree: [{
//        state: ['user', 'leaf'],
        text: 'Куницына А.Б.',
				isLeaf: true,
				icon: 'user'
      }, {
//        state: ['user', 'leaf'],
        text: 'Медведев Р.В.',
				isLeaf: true,
				icon: 'user'
      }]
    }, {
      text: 'каб. 113',
      icon: 'door'
    }]
  }]
});
	
	
});	
	
</script>	
<div class="html">
	
</div>
<div class="desc">
	
</div>
</div>









</body>
</html>