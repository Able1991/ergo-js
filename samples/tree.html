<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DinoJS: Деревья</title>

		<!-- jQuery -->
		<script type="text/javascript" src="../lib/misc/jquery-1.4.2.min.js"></script>
		<!-- DinoJS -->
		<script type="text/javascript" src="../build/dino-js.js"></script>
		<link rel="stylesheet" type="text/css" href="../build/dino-js.css">
		<!-- DinoJS theme -->
		<link rel="stylesheet" type="text/css" href="../themes/default/dino-theme.css">
		<!-- jQuery UI theme -->
		<link rel="stylesheet" type="text/css" href="../themes/smoothness/jquery-ui-theme.css">
		<!-- SHJS -->
		<script type="text/javascript" src="../lib/shjs/sh_main.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_javascript.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_css.min.js"></script>
		<script type="text/javascript" src="../lib/shjs/lang/sh_html.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../lib/shjs/css/sh_emacs.min.css">

		<link rel="stylesheet" type="text/css" href="css/template2.css">
		<script type="text/javascript" src="js/template2.js"></script>


</head>
<body>






<div id="sample-simple-tree">
<style>	
/*
.simple-tree-node > ul {
	padding-left: 20px;
}
*/
	
</style>
<script>
$.dino({
  dtype: 'tree',
	cls: 'simple-tree',
	
	treeModel: {
		node: {
			cls: 'simple-tree-node',
			expandOnShow: true,
			components: {
				content: {
					showLeftIcon: true,
					components: {
						leftIcon: {
							states: {
	              'brick': 'led-icon-brick',
	              'door': 'led-icon-door',
	              'user': 'led-icon-user'								
							}
						}
					}
				}				
			}
		}
	},
  subtree: [{
    label: '1 этаж',
    state: 'brick',
		toggleOnClick: true,
    subtree: [{
      label: 'каб. 111',
      state: 'door',
      subtree: [{
        state: ['user', 'leaf'],
        label: 'Волков А.А.'
//				isLeaf: true
      }]
    }, {
      label: 'каб. 112',
      state: 'door',
      subtree: [{
        state: ['user', 'leaf'],
        label: 'Куницына А.Б.'
//				isLeaf: true
      }, {
        state: ['user', 'leaf'],
        label: 'Медведев Р.В.'
//				isLeaf: true
      }]
    }, {
      label: 'каб. 113',
      state: 'door'
    }]
  }]
});
</script>	
<div class="html">
	
</div>
<div class="desc">
	
</div>
</div>





<div id="sample-binding-tree">
<style>	

.dynamic-tree .dino-tree-node-content:hover {
	background-color: #fea;
}


</style>
<script>
	
var treeData = [{
  name: 'Хряков С.И.',
  type: 'computer',
  children: [{
    name: 'C:',
    type: 'drive',
    children: [{
      name: 'WINDOWS',
      type: 'folder'
    }]
  }, {
    name: 'D:',
    type: 'drive',
    children: [{
      name: 'Фильмы',
      type: 'folder',
      children: [{
        name: 'Звездные Войны 1.avi',
        type: 'file'
      }, {
        name: 'Звездные Войны 3.avi',
        type: 'file'
      }, {
        name: 'Миссия Серенити.avi',
        type: 'file'
      }]
    }, {
      name: 'Работа',
      type: 'folder',
      children: [{
        name: 'bash.org.ru_лучшее.txt',
        type: 'file'
      }]
    }, {
      name: 'README.txt',
      type: 'file'
    }]
  }, {
    name: 'Z:',
    type: 'drive',
  }]
}];	
	

$.dino({
  dtype: 'tree',
	cls: 'dynamic-tree',
	
  data: treeData,
	
  isDynamic: true,
	
	treeModel: {
		node: {
			cls: 'dynamic-tree-node',
			components: {
		    content: {
		      components: {
		        leftIcon: {
		          states: {
		            'computer': 'led-icon-computer',
		            'drive': 'led-icon-drive',
		            'folder': 'led-icon-folder',
		            'file': 'led-icon-page',
		          }
		        },
		      },
					showLeftIcon: true,
		      dataId: 'name'
		    }				
			},
			binding: {
				states: function(s) {
					var type = this.data.get('type');
					s.set(type);
					if(type == 'file') s.set('leaf');
				}
			}
		}
	}
	
});

</script>	
<div class="html">
	
</div>
<div class="desc">
	
</div>
</div>




<script>
/*	
var drag = null;
var proxy = null;	

$('body').mousemove(function(e){
	if(!drag) return;
	
	if(!drag.started) {
//		if(drag.x != e.pageX || drag.y != e.pageY){
			
//		}
	}
	else {
		proxy.el.css({'left': e.pageX+3, 'top': e.pageY+3});
	}
	
});
	
	
$('body').mouseup(function(e){
	
	if(drag && drag.started) {
		proxy.destroy();
		
		var target = $(e.originalTarget);
		var w = target.dino();
		if(!w || !w.options.dropTarget){
			target.parents().each(function(i, el){
				w = $(el).dino();
				if(w && w.options.dropTarget) return false;
			});
		}
		
		if(w) {
			w.events.fire('onDrop', {source: drag.source});
		}
		
		drag = null;
	}
	
});	
*/	
	
	
</script>




<div id="sample-tree-dragndrop">
<style>	
	
</style>
<script>
$.dino({
  dtype: 'tree',
	cls: 'simple-tree',
	
	treeModel: {
		node: {
			cls: 'simple-tree-node',
			expandOnShow: true,
			components: {
				content: {
					cls: 'dino-clickable',
					showLeftIcon: true,
					components: {
						leftIcon: {
							states: {
	              'brick': 'led-icon-brick',
	              'door': 'led-icon-door',
	              'user': 'led-icon-user'								
							}
						}
					},
/*					
					events: {
						// обработчик mousedown, т.к. это drag source
						'mousedown': function(e) {
							if(!Dino.drag) {
								Dino.drag = {
									started: false,
									source: $(this).dino()
								}						
							}
						},
						'mouseout': function(e, w) {
							
							var drag = Dino.drag;
							
							if(drag && drag.source == w && !drag.started){
								drag.started = true;
								drag.source.events.fire('onDragStarted', {dragData: drag});
								
								drag.dragProxy = $.dino({
									renderTo: 'body',
									dtype: 'text',
									text: w.getText(),
									cls: 'dino-border-all',
									style: {'position': 'absolute', 'background-color': '#fff'},
									opacity: .7
								});								
							}
						}
					},
*/					

					draggable: true,
					onDragStart: function(e) {
						this.parent.states.set('dragged');
						
						e.dragData.proxy = $.dino({
							dtype: 'text',
							text: this.getText(),
							cls: 'dino-border-all',
							style: {'background-color': '#fff'},
							opacity: .7
						});
						
					},
					onDrop: function(e) {
						if(this != e.source)
							this.parent.subtree.addItem(e.source.parent);
							
						e.source.parent.states.clear('dragged');
					},
					dropTarget: true
				}		
			},
//			states: {
//				'dragged': 'dino-hidden'
//			}
		}
	},
  subtree: [{
    label: '1 этаж',
    state: 'brick',
		toggleOnClick: true,
    subtree: [{
      label: 'каб. 111',
      state: 'door',
      subtree: [{
        state: ['user', 'leaf'],
        label: 'Волков А.А.'
//				isLeaf: true
      }]
    }, {
      label: 'каб. 112',
      state: 'door',
      subtree: [{
        state: ['user', 'leaf'],
        label: 'Куницына А.Б.'
//				isLeaf: true
      }, {
        state: ['user', 'leaf'],
        label: 'Медведев Р.В.'
//				isLeaf: true
      }]
    }, {
      label: 'каб. 113',
      state: 'door'
    }]
  }]
});
</script>	
<div class="html">
	
</div>
<div class="desc">
	
</div>
</div>








<script>
	
	
samplePage([{
	name: 'Простое дерево',
	id: '#sample-simple-tree'
}, {
	name: 'Binding',
	id: '#sample-binding-tree'
}, {
	name: "Drag'n'drop",
	id: '#sample-tree-dragndrop'
}]);
	
		
	
</script>


</body>
</html>