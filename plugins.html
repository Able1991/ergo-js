<!DOCTYPE html>
<html class="js canvas canvastext geolocation rgba hsla no-multiplebgs borderimage borderradius boxshadow opacity no-cssanimations csscolumns no-cssgradients no-cssreflections csstransforms no-csstransforms3d no-csstransitions  video audio cufon-active fontface cufon-ready">
<head>
	<meta charset="utf-8" />
	
	
		<!-- STYLES -->
	
		<link rel="stylesheet/less" href="samples/css/ergo-js.less" type="text/css" />
		<link rel="stylesheet/less" href="themes/default/ergo-theme.less" type="text/css" />

		<link rel="stylesheet/less" href="iconsets/font-awesome/less/font-awesome.less" type="text/css" />

		<script src="lib/misc/less-1.3.0.min.js" type="text/javascript"></script>
	

		<script src="lib/misc/jquery-1.8.2.min.js" type="text/javascript"></script>
		<script src="build/ergo-js.js" type="text/javascript"></script>
		
		<script src="plugins/ajax-tree/ajax-tree.js" type="text/javascript"></script>
	
		<script src="plugins/ajax-grid/ajax-grid.js" type="text/javascript"></script>
	
	
	
	<style type="text/css">
		
		body {
			padding: 20px;
		}
		
	</style>
	
</head>
<body>
	
	
<script type="text/javascript">
	
$(document).ready(function(){
	
	
	var treeData = new Ergo.plugins.tree.NodeCollection([], {path: 'plugins/ajax-tree/ajax/tree'});
	
	
	
	$.ergo({
		etype: 'panel',
		renderTo: 'body',
		width: 600,
		height: 300,
		title: 'Дерево (ajax)',
		cls: 'widget',
		style: {'margin-bottom': 20},
		
		content: {
			etype: 'ajax-tree',
			data: treeData,
			
			node: {
				onDataChanged: function() {
					var v = this.getValue();
					this.content.opt('icon', v.children ? 'icon-folder-close' : 'icon-file' );
				}
			}
							
		}		
		
	});
	
	treeData.fetch('plugins/ajax-tree/ajax/tree/0');
	
	
	
	
	
	var gridData = new Ergo.data.PageAjaxCollection([], {
//		mixins: ['pageable'],
		cache: false,
		pageSize: 7,
		totalCount: 1,
		path: 'plugins/ajax-grid/ajax/0',
		parse: function(json) {
			
			this.options.totalCount = json.total;
			
			var data = [];
			
			var to = Math.min(json.total, this.options.to);
			
			for(var i = this.options.from; i < to; i++) data.push(json.data[i]);
			
			
			return data;
		}
	});
	
	
	
	
	var grid = $.ergo({
		etype: 'ajax-grid-panel',
		renderTo: 'body',
		width: 600,
		height: 300,
		title: 'Таблица (ajax)',
		cls: 'widget',
		
		data: gridData,
		
		components: {
			header: {
				tools: ['Добавить', 'Удалить', 'Обновить']
			}
		},
		
		
		content: {
			columns: [{
				dataId: 'id',
				header: 'ID'
			}, {
				dataId: 'name',
				header: 'Имя'
			}, {
				dataId: 'post',
				header: 'Должность'
			}, {
				dataId: 'department',
				header: 'Подразделение'
			}]
		}
		
		
	});
	
	
	grid.footer.content.item(2).setIndex(1);
	
	// gridData.fetch().then(function(){
		// grid.$layoutChanged();
	// });
	
	
	
	
	/**
	 * 
	 * 
	 */
	
	$.ergo({
		etype: 'panel',
		renderTo: 'body',
		style: {'margin-top': 20},
		title: 'Панель инструметов',
		
		content: {
			etype: 'tool-box',
			items: [{
				etype: 'button-item',
				text: 'Печать',
				icon: 'icon-print'
			}, {
				etype: 'button-group',
				defaultItem: {
					etype: 'button'
				},
				items: ['Добавить', 'Удалить', 'Изменить']
			}, {
				cls: 'e-splitter'
			}, {
				etype: 'grid-paginator'
			}]
		}
		
	});
	
	
	
	
	/**
	 * 
	 * 
	 * 
	 */
	$.ergo({
		etype: 'panel',
		renderTo: 'body',
		style: {'margin-top': 20},
		title: 'Панель инструметов',
		
		content: {
			etype: 'tool-box',
			items: [{
				etype: 'button-item',
				text: 'Диалог',
				onClick: function() {
					
					var dlg = new Ergo.widgets.Dialog({
						width: 300,
						height: 300,
						title: 'Диалог',
						cls: 'widget',
						
						buttons: ['ok', 'cancel'],
						
						content: {
							layout: 'form',
							items: [{
								label: 'Имя',
								etype: 'input-box'
							}, {
								label: 'Должность',
								etype: 'dropdown-select',
								dropdownItems: ['Главный специалист', 'Начальник отдела', 'Ведущий специалист']
							}]
						}
					});
					
					dlg.open();
					
				}
			}]
		}
	});
	
	
	
	
	
	$.ergo({
		etype: 'panel',
		renderTo: 'body',
		style: {'margin-top': 20},
		title: 'Меню',
		
		content: {
			etype: 'list',
			cls: 'e-main-menu',
			mixins: ['selectable'],
			components: {
				logo: {
					etype: 'box',
					weight: -10,
					cls: 'logo',
					content: {
						etype: 'image'
					}
				}
			},
			defaultItem: {
				onClick: function() {
					this.parent.selection.set(this);
				}
			},
			items: ['Страница 1', 'Страница 2', 'Страница 3']
		}
		
	});
	
	
	
	
});	
	
	
</script>	
	
</body>
</html>